---
import Layout from "src/layouts/Layout.astro";
import SingleBlogPost from "@components/blog/SingleBlogPost";
import type { PostServerModel } from "@localTypes/post-model";

export async function getStaticPaths() {
  const data: PostServerModel[] = await fetch(
    `${import.meta.env.API_URI}/posts`
  ).then(response => response.json());

  return data.map(post => {
    return {
      params: { id: String(post.id) },
      props: { post },
    };
  });
}

const { id } = Astro.params;
if (!id) throw Error("Id must be defined.");
---

<Layout>
  <SingleBlogPost client:load path={`${import.meta.env.API_URI}/posts/${id}`} />
</Layout>
